"use strict";var RrdGraphDescError=function(s){this.name="RrdGraphDescError",this.message=s?s:"Error"};RrdGraphDescError.prototype=new Error;var RrdGraphDesc=function(s){this.gf=null,this.stack=!1,this.debug=!1,this.vname=null,this.vidx=Number.NaN,this.rrd=null,this.ds_nam=null,this.ds=-1,this.cf=RrdGraphDesc.CF_AVERAGE,this.cf_reduce=RrdGraphDesc.CF_AVERAGE,this.col=null,this.format=null,this.legend=null,this.strftm=!1,this.leg_x=0,this.leg_y=0,this.yrule=Number.NaN,this.xrule=0,this.vf=null,this.rpnp=null,this.shidx=0,this.shval=0,this.shift=0,this.start=s.start,this.end=s.end,this.start_orig=s.start,this.end_orig=s.end,this.step=s.step,this.step_orig=s.step,this.ds_cnt=0,this.data_first=0,this.ds_namv=[],this.data=[],this.p_data=[],this.linewidth=0,this.dash=!1,this.p_dashes=[],this.ndash=!1,this.offset=0,this.txtalign=0;var t=[],i=arguments[1];t[0]=arguments[0];for(var e=2;e<arguments.length;e++)t[e-1]=arguments[e];switch(i){case RrdGraphDesc.GF_GPRINT:this.gprint.apply(this,t);break;case RrdGraphDesc.GF_COMMENT:this.comment.apply(this,t);break;case RrdGraphDesc.GF_HRULE:this.hrule.apply(this,t);break;case RrdGraphDesc.GF_VRULE:this.vrule.apply(this,t);break;case RrdGraphDesc.GF_LINE:this.line.apply(this,t);break;case RrdGraphDesc.GF_AREA:this.area.apply(this,t);break;case RrdGraphDesc.GF_TICK:this.tick.apply(this,t);break;case RrdGraphDesc.GF_TEXTALIGN:this.textalign.apply(this,t);break;case RrdGraphDesc.GF_DEF:this.def.apply(this,t);break;case RrdGraphDesc.GF_CDEF:this.cdef.apply(this,t);break;case RrdGraphDesc.GF_VDEF:this.vdef.apply(this,t);break;case RrdGraphDesc.GF_SHIFT:this.fshift.apply(this,t)}};RrdGraphDesc.GF_PRINT=0,RrdGraphDesc.GF_GPRINT=1,RrdGraphDesc.GF_COMMENT=2,RrdGraphDesc.GF_HRULE=3,RrdGraphDesc.GF_VRULE=4,RrdGraphDesc.GF_LINE=5,RrdGraphDesc.GF_AREA=6,RrdGraphDesc.GF_STACK=7,RrdGraphDesc.GF_TICK=8,RrdGraphDesc.GF_TEXTALIGN=9,RrdGraphDesc.GF_DEF=10,RrdGraphDesc.GF_CDEF=11,RrdGraphDesc.GF_VDEF=12,RrdGraphDesc.GF_SHIFT=13,RrdGraphDesc.GF_XPORT=14,RrdGraphDesc.CF_AVERAGE=0,RrdGraphDesc.CF_MINIMUM=1,RrdGraphDesc.CF_MAXIMUM=2,RrdGraphDesc.CF_LAST=3,RrdGraphDesc.CF_HWPREDICT=4,RrdGraphDesc.CF_SEASONAL=5,RrdGraphDesc.CF_DEVPREDICT=6,RrdGraphDesc.CF_DEVSEASONAL=7,RrdGraphDesc.CF_FAILURES=8,RrdGraphDesc.CF_MHWPREDICT=9,RrdGraphDesc.TXA_LEFT=0,RrdGraphDesc.TXA_RIGHT=1,RrdGraphDesc.TXA_CENTER=2,RrdGraphDesc.TXA_JUSTIFIED=3,RrdGraphDesc.cf_conv=function(s){switch(s){case"AVERAGE":return RrdGraphDesc.CF_AVERAGE;case"MIN":return RrdGraphDesc.CF_MINIMUM;case"MAX":return RrdGraphDesc.CF_MAXIMUM;case"LAST":return RrdGraphDesc.CF_LAST;case"HWPREDICT":return RrdGraphDesc.CF_HWPREDICT;case"MHWPREDICT":return RrdGraphDesc.CF_MHWPREDICT;case"DEVPREDICT":return RrdGraphDesc.CF_DEVPREDICT;case"SEASONAL":return RrdGraphDesc.CF_SEASONAL;case"DEVSEASONAL":return RrdGraphDesc.CF_DEVSEASONAL;case"FAILURES":return RrdGraphDesc.CF_FAILURES}return-1},RrdGraphDesc.cf2str=function(s){switch(s){case RrdGraphDesc.CF_AVERAGE:return"AVERAGE";case RrdGraphDesc.CF_MINIMUM:return"MIN";case RrdGraphDesc.CF_MAXIMUM:return"MAX";case RrdGraphDesc.CF_LAST:return"LAST";case RrdGraphDesc.CF_HWPREDICT:return"HWPREDICT";case RrdGraphDesc.CF_MHWPREDICT:return"MHWPREDICT";case RrdGraphDesc.CF_DEVPREDICT:return"DEVPREDICT";case RrdGraphDesc.CF_SEASONAL:return"SEASONAL";case RrdGraphDesc.CF_DEVSEASONAL:return"DEVSEASONAL";case RrdGraphDesc.CF_FAILURES:return"FAILURES"}return""},RrdGraphDesc.prototype.def=function(s,t,i,e,r,h,a,d,n){var g=new RrdTime(this.start),_=new RrdTime(this.end);this.gf=RrdGraphDesc.GF_DEF,this.vname=t,this.vidx=s.find_var(t),this.rrd=i,this.ds_nam=e,this.cf=RrdGraphDesc.cf_conv(r),void 0!=h&&null!=h&&(this.step=h,this.step_orig=h),void 0!=a&&null!=a&&(g=new RrdTime(a)),void 0!=d&&null!=d&&(_=new RrdTime(d)),void 0===n||null===n?this.cf_reduce=this.cf:this.cf_reduce=RrdGraphDesc.cf_conv(n),this.legend="";var o=RrdTime.proc_start_end(g,_);this.start=o[0],this.end=o[1],this.start_orig=o[0],this.end_orig=o[1]},RrdGraphDesc.prototype.cdef=function(s,t,i){this.gf=RrdGraphDesc.GF_CDEF,this.vname=t,this.vidx=s.find_var(t),this.rpnp=new RrdRpn(i,s.gdes),this.legend=""},RrdGraphDesc.prototype.vdef=function(s,t,i){this.gf=RrdGraphDesc.GF_VDEF,this.vname=t;var e=i.indexOf(","),r=i.substring(0,e);if(this.vidx=s.find_var(r),s.gdes[this.vidx].gf!=RrdGraphDesc.GF_DEF&&s.gdes[this.vidx].gf!=RrdGraphDesc.GF_CDEF)throw new RrdGraphDescError('variable "'+r+'" not DEF nor CDEF in VDEF.');this.vf=new RrdVdef(r,i.substring(e+1)),this.legend=""},RrdGraphDesc.prototype.fshift=function(s,t,i){if(this.gf=RrdGraphDesc.GF_SHIFT,this.vname=t,this.vidx=s.find_var(t),s.gdes[this.vidx].gf===RrdGraphDesc.GF_VDEF)throw new RrdGraphDescError("Cannot shift a VDEF: '%s' in line '"+s.gdes[this.vidx].vname+"'");if(s.gdes[this.vidx].gf!==RrdGraphDesc.GF_DEF&&s.gdes[this.vidx].gf!==RrdGraphDesc.GF_CDEF)throw new RrdGraphDescError("Encountered unknown type variable '"+s.gdes[this.vidx].vname+"'");if(this.shidx=s.find_var(i),this.shidx>=0){if(s.gdes[this.shidx].gf===RrdGraphDesc.GF_DEF||s.gdes[this.shidx].gf===RrdGraphDesc.GF_CDEF)throw new RrdGraphDescError("Offset cannot be a (C)DEF: '"+s.gdes[this.shidx].gf+"'");if(s.gdes[this.shidx].gf!==RrdGraphDesc.GF_VDEF)throw new RrdGraphDescError("Encountered unknown type variable '"+s.gdes[this.shidx].vname+"'")}else this.shval=parseInt(i,10),this.shidx=-1;this.legend=""},RrdGraphDesc.prototype.line=function(s,t,i,e,r,h,a,d){this.gf=RrdGraphDesc.GF_LINE,this.vname=i,this.vidx=s.find_var(i),this.linewidth=t,this.col=e,void 0===r?this.legend="":0===r.length?this.legend="":this.legend="  "+r,void 0===h?this.stack=!1:this.stack=h,this.format=this.legend,void 0!=a&&(this.dash=!0,this.p_dashes=a,this.ndash=a.length),void 0!=d&&(this.offset=d)},RrdGraphDesc.prototype.area=function(s,t,i,e,r){this.gf=RrdGraphDesc.GF_AREA,this.vname=t,this.vidx=s.find_var(t),this.col=i,void 0===e?this.legend="":0===e.length?this.legend="":this.legend="  "+e,void 0===r?this.stack=!1:this.stack=r,this.format=this.legend},RrdGraphDesc.prototype.tick=function(s,t,i,e,r){this.gf=RrdGraphDesc.GF_TICK,this.vname=t,this.vidx=s.find_var(t),this.col=i,void 0!==e?this.yrule=e:this.yrule=.1,void 0===r?this.legend="":0===r.length?this.legend="":this.legend="  "+r,this.format=this.legend},RrdGraphDesc.prototype.gprint=function(s,t,i,e,r){if(this.gf=RrdGraphDesc.GF_GPRINT,this.vname=t,this.vidx=s.find_var(t),this.legend="",-1==this.vidx)throw new RrdGraphDescError("Cannot find var name: "+t);if(e)this.cf=RrdGraphDesc.cf_conv(i),this.format=e;else switch(this.format=i,s.gdes[this.vidx].gf){case RrdGraphDesc.GF_DEF:case RrdGraphDesc.GF_CDEF:this.cf=s.gdes[this.vidx].cf;break;case RrdGraphDesc.GF_VDEF:break;default:throw new RrdGraphDescError("Encountered unknown type variable "+s.gdes[this.vidx].vname)}s.gdes[this.vidx].gf===RrdGraphDesc.GF_VDEF&&r===!0&&(this.strftm=!0)},RrdGraphDesc.prototype.comment=function(s,t){this.gf=RrdGraphDesc.GF_COMMENT,this.vidx=-1,this.legend=t},RrdGraphDesc.prototype.textalign=function(s,t){if(this.gf=RrdGraphDesc.GF_TEXTALIGN,this.vidx=-1,"left"===t)this.txtalign=RrdGraphDesc.TXA_LEFT;else if("right"===t)this.txtalign=RrdGraphDesc.TXA_RIGHT;else if("justified"===t)this.txtalign=RrdGraphDesc.TXA_JUSTIFIED;else{if("center"!==t)throw new RrdGraphDescError("Unknown alignement type '"+t+"'");this.txtalign=RrdGraphDesc.TXA_CENTER}},RrdGraphDesc.prototype.vrule=function(s,t,i,e,r,h){this.gf=RrdGraphDesc.GF_VRULE,this.xrule=t,this.col=i,void 0===e?this.legend="":0===e.length?this.legend="":this.legend="  "+e,void 0!=r&&(this.dash=!0,this.p_dashes=r,this.ndash=r.length),void 0!=h&&(this.offset=h)},RrdGraphDesc.prototype.hrule=function(s,t,i,e,r,h){this.gf=RrdGraphDesc.GF_HRULE,this.vidx=s.find_var(t),-1==this.vidx&&(this.yrule=t),this.col=i,void 0===e?this.legend="":0===e.length?this.legend="":this.legend="  "+e,void 0!=r&&(this.dash=!0,this.p_dashes=r,this.ndash=r.length),void 0!=h&&(this.offset=h)};var RrdVdefError=function(s){this.name="RrdVdefError",this.message=s?s:"Error"};RrdVdefError.prototype=new Error;var RrdVdef=function(s,t){var i,e;this.expr=t,this.op=null,this.param=null,this.val=null,this.when=null;var r=t.indexOf(",");if(-1!=r?(i=parseFloat(t.substr(0,r)),e=t.substr(r+1)):(i=Number.NaN,e=t),"PERCENT"===e)this.op=RrdVdef.VDEF_PERCENT;else if("PERCENTNAN"===e)this.op=RrdVdef.VDEF_PERCENTNAN;else if("MAXIMUM"===e)this.op=RrdVdef.VDEF_MAXIMUM;else if("AVERAGE"===e)this.op=RrdVdef.VDEF_AVERAGE;else if("STDEV"===e)this.op=RrdVdef.VDEF_STDEV;else if("MINIMUM"===e)this.op=RrdVdef.VDEF_MINIMUM;else if("TOTAL"===e)this.op=RrdVdef.VDEF_TOTAL;else if("FIRST"===e)this.op=RrdVdef.VDEF_FIRST;else if("LAST"===e)this.op=RrdVdef.VDEF_LAST;else if("LSLSLOPE"===e)this.op=RrdVdef.VDEF_LSLSLOPE;else if("LSLINT"===e)this.op=RrdVdef.VDEF_LSLINT;else{if("LSLCORREL"!==e)throw new RrdVdefError('Unknown function "'+e+'" in VDEF "'+s+'"');this.op=RrdVdef.VDEF_LSLCORREL}switch(this.op){case RrdVdef.VDEF_PERCENT:case RrdVdef.VDEF_PERCENTNAN:if(isNaN(i))throw new RrdVdefError("Function '"+e+"' needs parameter in VDEF '"+s+"'");if(!(i>=0&&100>=i))throw new RrdVdefError("Parameter '"+i+"' out of range in VDEF '"+s+"'");this.param=i,this.val=Number.NaN,this.when=0;break;case RrdVdef.VDEF_MAXIMUM:case RrdVdef.VDEF_AVERAGE:case RrdVdef.VDEF_STDEV:case RrdVdef.VDEF_MINIMUM:case RrdVdef.VDEF_TOTAL:case RrdVdef.VDEF_FIRST:case RrdVdef.VDEF_LAST:case RrdVdef.VDEF_LSLSLOPE:case RrdVdef.VDEF_LSLINT:case RrdVdef.VDEF_LSLCORREL:if(!isNaN(i))throw new RrdVdefError("Function '"+e+"' needs no parameter in VDEF '"+s+"'");this.param=Number.NaN,this.val=Number.NaN,this.when=0}};RrdVdef.VDEF_MAXIMUM=0,RrdVdef.VDEF_MINIMUM=1,RrdVdef.VDEF_AVERAGE=2,RrdVdef.VDEF_STDEV=3,RrdVdef.VDEF_PERCENT=4,RrdVdef.VDEF_TOTAL=5,RrdVdef.VDEF_FIRST=6,RrdVdef.VDEF_LAST=7,RrdVdef.VDEF_LSLSLOPE=8,RrdVdef.VDEF_LSLINT=9,RrdVdef.VDEF_LSLCORREL=10,RrdVdef.VDEF_PERCENTNAN=11,RrdVdef.prototype.vdef_percent_compar=function(s,t){return isNaN(s)?-1:isNaN(t)?1:isFinite(s)?isFinite(t)?t>s?-1:1:t===-(1/0)?-1:1:s===-(1/0)?-1:1},RrdVdef.prototype.calc=function(s){var t,i,e,r,h=[],a=0;switch(t=s.data,e=(s.end-s.start)/s.step,this.op){case RrdVdef.VDEF_PERCENT:for(i=0;e>i;i++)h[i]=t[i*s.ds_cnt];h.sort(this.vdef_percent_compar),r=Math.round(this.param*(e-1)/100),this.val=h[r],this.when=0;break;case RrdVdef.VDEF_PERCENTNAN:for(r=0,i=0;e>i;i++)isNaN(t[i*s.ds_cnt])||(h[r]=t[i*s.ds_cnt]);h.sort(this.vdef_percent_compar),r=Math.round(this.param*(r-1)/100),this.val=h[r],this.when=0;break;case RrdVdef.VDEF_MAXIMUM:for(i=0;i!=e&&isNaN(t[i*s.ds_cnt]);)i++;for(i===e?(this.val=Number.NaN,this.when=0):(this.val=t[i*s.ds_cnt],this.when=s.start+(i+1)*s.step);i!=e;)isFinite(t[i*s.ds_cnt])&&t[i*s.ds_cnt]>this.val&&(this.val=t[i*s.ds_cnt],this.when=s.start+(i+1)*s.step),i++;break;case RrdVdef.VDEF_TOTAL:case RrdVdef.VDEF_STDEV:case RrdVdef.VDEF_AVERAGE:var d=0,n=0;for(i=0;e>i;i++)isFinite(t[i*s.ds_cnt])&&(d+=t[i*s.ds_cnt],a++);if(a)if(this.op===RrdVdef.VDEF_TOTAL)this.val=d*s.step,this.when=0;else if(this.op===RrdVdef.VDEF_AVERAGE)this.val=d/a,this.when=0;else{for(n=d/a,d=0,i=0;e>i;i++)isFinite(t[i*s.ds_cnt])&&(d+=Math.pow(t[i*s.ds_cnt]-n,2));this.val=Math.pow(d/a,.5),this.when=0}else this.val=Number.NaN,this.when=0;break;case RrdVdef.VDEF_MINIMUM:for(i=0;i!=e&&isNaN(t[i*s.ds_cnt]);)i++;for(i===e?(this.val=Number.NaN,this.when=0):(this.val=t[i*s.ds_cnt],this.when=s.start+(i+1)*s.step);i!=e;)isFinite(t[i*s.ds_cnt])&&t[i*s.ds_cnt]<this.val&&(this.val=t[i*s.ds_cnt],this.when=s.start+(i+1)*s.step),i++;break;case RrdVdef.VDEF_FIRST:for(i=0;i!=e&&isNaN(t[i*s.ds_cnt]);)i++;i===e?(this.val=Number.NaN,this.when=0):(this.val=t[i*s.ds_cnt],this.when=s.start+i*s.step);break;case RrdVdef.VDEF_LAST:for(i=e-1;i>=0&&isNaN(t[i*s.ds_cnt]);)i--;0>i?(this.val=Number.NaN,this.when=0):(this.val=t[i*s.ds_cnt],this.when=s.start+(i+1)*s.step);break;case RrdVdef.VDEF_LSLSLOPE:case RrdVdef.VDEF_LSLINT:case RrdVdef.VDEF_LSLCORREL:var g,_,o,p,l,c,R,f;for(g=0,_=0,o=0,p=0,l=0,i=0;e>i;i++)isFinite(t[i*s.ds_cnt])&&(a++,g+=i,p+=i*i,o+=i*t[i*s.ds_cnt],_+=t[i*s.ds_cnt],l+=t[i*s.ds_cnt]*t[i*s.ds_cnt]);c=(g*_-a*o)/(g*g-a*p),R=(_-c*g)/a,f=(o-g*_/a)/Math.sqrt((p-g*g/a)*(l-_*_/a)),a?this.op===RrdVdef.VDEF_LSLSLOPE?(this.val=c,this.when=0):this.op===RrdVdef.VDEF_LSLINT?(this.val=R,this.when=0):this.op===RrdVdef.VDEF_LSLCORREL&&(this.val=f,this.when=0):(this.val=Number.NaN,this.when=0)}return 0};var RrdGraphError=function(s){this.name="RrdGraphError",this.message=s?s:"Error"};RrdGraphError.prototype=new Error;var RrdGraph=function(s,t){this.gfx=s,this.data=t,this.data_need_fetch=[],this.minval=Number.NaN,this.maxval=Number.NaN,this.xorigin=0,this.yorigin=0,this.xOriginTitle=0,this.yOriginTitle=0,this.xOriginLegendY=0,this.yOriginLegendY=0,this.xOriginLegendY2=0,this.yOriginLegendY2=0,this.xOriginLegend=0,this.yOriginLegend=0,this.ximg=0,this.yimg=0,this.legendwidth=0,this.legendheight=0,this.magfact=1,this.symbol=null,this.viewfactor=1,this.base=1e3,this.start=0,this.end=0,this.xlab_form=null,this.xsize=400,this.ysize=100,this.zoom=1,this.grid_dash_on=1,this.grid_dash_off=1,this.second_axis_scale=0,this.second_axis_shift=0,this.second_axis_legend=null,this.second_axis_format=null,this.draw_x_grid=!0,this.draw_y_grid=!0,this.ygridstep=Number.NaN,this.ylabfact=0,this.draw_3d_border=2,this.dynamic_labels=!1,this.ylegend=null,this.title="",this.watermark=null,this.tabwidth=40,this.step=0,this.step_orig=0,this.setminval=Number.NaN,this.setmaxval=Number.NaN,this.rigid=!1,this.gridfit=!0,this.lazy=0,this.legendposition=RrdGraph.LEGEND_POS_SOUTH,this.legenddirection=RrdGraph.LEGEND_DIR_TOP_DOWN,this.logarithmic=!1,this.force_scale_min=0,this.force_scale_max=0,this.unitsexponent=9999,this.unitslength=6,this.forceleftspace=!1,this.slopemode=!1,this.alt_ygrid=!1,this.alt_autoscale=!1,this.alt_autoscale_min=!1,this.alt_autoscale_max=!1,this.no_legend=!1,this.no_minor=!1,this.only_graph=!1,this.force_rules_legend=!1,this.force_units=!1,this.force_units_si=!1,this.full_size_mode=!1,this.no_rrdtool_tag=!1,this.xlab_user=null,this.ygrid_scale=null,this.gdes=[],this.ytr_pixie=0,this.xtr_pixie=0,this.AlmostEqualBuffer=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT),this.AlmostEqualInt=new Int32Array(this.AlmostEqualBuffer),this.AlmostEqualFloat=new Float32Array(this.AlmostEqualBuffer),this.DEFAULT_FONT="'DejaVu Sans Mono', 'Courier', 'Ubuntu Mono'",this.MGRIDWIDTH=.6,this.GRIDWIDTH=.4,this.YLEGEND_ANGLE=90,this.TEXT={DEFAULT:{size:11,font:this.DEFAULT_FONT},TITLE:{size:12,font:this.DEFAULT_FONT},AXIS:{size:10,font:this.DEFAULT_FONT},UNIT:{size:11,font:this.DEFAULT_FONT},LEGEND:{size:11,font:this.DEFAULT_FONT},WATERMARK:{size:8,font:this.DEFAULT_FONT}},this.GRC={CANVAS:"rgba(255, 255, 255, 1.0)",BACK:"rgba(242,242, 242, 1.0)",SHADEA:"rgba(207, 207, 207, 1.0)",SHADEB:"rgba(158, 158, 158, 1.0)",GRID:"rgba(143, 143, 143, 0.75)",MGRID:"rgba(222, 79, 79, 0.60)",FONT:"rgba(0, 0, 0, 1.0)",ARROW:"rgba(127, 31, 31, 1.0)",AXIS:"rgba(31, 31, 31, 1.0)",FRAME:"rgba(0, 0, 0, 1.0)"},this.xlab=[{minsec:0,length:0,gridtm:RrdGraph.TMT_SECOND,gridst:30,mgridtm:RrdGraph.TMT_MINUTE,mgridst:5,labtm:RrdGraph.TMT_MINUTE,labst:5,precis:0,stst:"%H:%M"},{minsec:2,length:0,gridtm:RrdGraph.TMT_MINUTE,gridst:1,mgridtm:RrdGraph.TMT_MINUTE,mgridst:5,labtm:RrdGraph.TMT_MINUTE,labst:5,precis:0,stst:"%H:%M"},{minsec:5,length:0,gridtm:RrdGraph.TMT_MINUTE,gridst:2,mgridtm:RrdGraph.TMT_MINUTE,mgridst:10,labtm:RrdGraph.TMT_MINUTE,labst:10,precis:0,stst:"%H:%M"},{minsec:10,length:0,gridtm:RrdGraph.TMT_MINUTE,gridst:5,mgridtm:RrdGraph.TMT_MINUTE,mgridst:20,labtm:RrdGraph.TMT_MINUTE,labst:20,precis:0,stst:"%H:%M"},{minsec:30,length:0,gridtm:RrdGraph.TMT_MINUTE,gridst:10,mgridtm:RrdGraph.TMT_HOUR,mgridst:1,labtm:RrdGraph.TMT_HOUR,labst:1,precis:0,stst:"%H:%M"},{minsec:60,length:0,gridtm:RrdGraph.TMT_MINUTE,gridst:30,mgridtm:RrdGraph.TMT_HOUR,mgridst:2,labtm:RrdGraph.TMT_HOUR,labst:2,precis:0,stst:"%H:%M"},{minsec:60,length:86400,gridtm:RrdGraph.TMT_MINUTE,gridst:30,mgridtm:RrdGraph.TMT_HOUR,mgridst:2,labtm:RrdGraph.TMT_HOUR,labst:6,precis:0,stst:"%a %H:%M"},{minsec:180,length:0,gridtm:RrdGraph.TMT_HOUR,gridst:1,mgridtm:RrdGraph.TMT_HOUR,mgridst:6,labtm:RrdGraph.TMT_HOUR,labst:6,precis:0,stst:"%H:%M"},{minsec:180,length:86400,gridtm:RrdGraph.TMT_HOUR,gridst:1,mgridtm:RrdGraph.TMT_HOUR,mgridst:6,labtm:RrdGraph.TMT_HOUR,labst:12,precis:0,stst:"%a %H:%M"},{minsec:600,length:0,gridtm:RrdGraph.TMT_HOUR,gridst:6,mgridtm:RrdGraph.TMT_DAY,mgridst:1,labtm:RrdGraph.TMT_DAY,labst:1,precis:86400,stst:"%a"},{minsec:1200,length:0,gridtm:RrdGraph.TMT_HOUR,gridst:6,mgridtm:RrdGraph.TMT_DAY,mgridst:1,labtm:RrdGraph.TMT_DAY,labst:1,precis:86400,stst:"%d"},{minsec:1800,length:0,gridtm:RrdGraph.TMT_HOUR,gridst:12,mgridtm:RrdGraph.TMT_DAY,mgridst:1,labtm:RrdGraph.TMT_DAY,labst:2,precis:86400,stst:"%a %d"},{minsec:2400,length:0,gridtm:RrdGraph.TMT_HOUR,gridst:12,mgridtm:RrdGraph.TMT_DAY,mgridst:1,labtm:RrdGraph.TMT_DAY,labst:2,precis:86400,stst:"%a"},{minsec:3600,length:0,gridtm:RrdGraph.TMT_DAY,gridst:1,mgridtm:RrdGraph.TMT_WEEK,mgridst:1,labtm:RrdGraph.TMT_WEEK,labst:1,precis:604800,stst:"Week %V"},{minsec:10800,length:0,gridtm:RrdGraph.TMT_WEEK,gridst:1,mgridtm:RrdGraph.TMT_MONTH,mgridst:1,labtm:RrdGraph.TMT_WEEK,labst:2,precis:604800,stst:"Week %V"},{minsec:21600,length:0,gridtm:RrdGraph.TMT_MONTH,gridst:1,mgridtm:RrdGraph.TMT_MONTH,mgridst:1,labtm:RrdGraph.TMT_MONTH,labst:1,precis:2592e3,stst:"%b"},{minsec:172800,length:0,gridtm:RrdGraph.TMT_MONTH,gridst:1,mgridtm:RrdGraph.TMT_MONTH,mgridst:3,labtm:RrdGraph.TMT_MONTH,labst:3,precis:2592e3,stst:"%b"},{minsec:315360,length:0,gridtm:RrdGraph.TMT_MONTH,gridst:3,mgridtm:RrdGraph.TMT_YEAR,mgridst:1,labtm:RrdGraph.TMT_YEAR,labst:1,precis:31536e3,stst:"%Y"},{minsec:864e3,length:0,gridtm:RrdGraph.TMT_YEAR,gridst:1,mgridtm:RrdGraph.TMT_YEAR,mgridst:1,labtm:RrdGraph.TMT_YEAR,labst:1,precis:31536e3,stst:"%y"},{minsec:-1,length:0,gridtm:RrdGraph.TMT_MONTH,gridst:0,mgridtm:RrdGraph.TMT_MONTH,mgridst:0,labtm:RrdGraph.TMT_MONTH,labst:0,precis:0,stst:null}],this.ylab=[{grid:.1,lfac:[1,2,5,10]},{grid:.2,lfac:[1,5,10,20]},{grid:.5,lfac:[1,2,4,10]},{grid:1,lfac:[1,2,5,10]},{grid:2,lfac:[1,5,10,20]},{grid:5,lfac:[1,2,4,10]},{grid:10,lfac:[1,2,5,10]},{grid:20,lfac:[1,5,10,20]},{grid:50,lfac:[1,2,4,10]},{grid:100,lfac:[1,2,5,10]},{grid:200,lfac:[1,5,10,20]},{grid:500,lfac:[1,2,4,10]},{grid:0,lfac:[0,0,0,0]}],this.si_symbol=["y","z","a","f","p","n","u","m"," ","k","M","G","T","P","E","Z","Y"],this.si_symbcenter=8,this.start_t=new RrdTime("end-24h"),this.end_t=new RrdTime("now")};RrdGraph.TMT_SECOND=0,RrdGraph.TMT_MINUTE=1,RrdGraph.TMT_HOUR=2,RrdGraph.TMT_DAY=3,RrdGraph.TMT_WEEK=4,RrdGraph.TMT_MONTH=5,RrdGraph.TMT_YEAR=6,RrdGraph.GFX_H_LEFT=1,RrdGraph.GFX_H_RIGHT=2,RrdGraph.GFX_H_CENTER=3,RrdGraph.GFX_V_TOP=1,RrdGraph.GFX_V_BOTTOM=2,RrdGraph.GFX_V_CENTER=3,RrdGraph.LEGEND_POS_NORTH=0,RrdGraph.LEGEND_POS_WEST=1,RrdGraph.LEGEND_POS_SOUTH=2,RrdGraph.LEGEND_POS_EAST=3,RrdGraph.LEGEND_DIR_TOP_DOWN=0,RrdGraph.LEGEND_DIR_BOTTOM_UP=1,RrdGraph.prototype.set_default_font=function(s){for(var t in this.TEXT)this.TEXT[t].font=s},RrdGraph.prototype.parse_color=function(s){var t;if(t=/^#?([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/.exec(s))return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),1];if(t=/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.exec(s))return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1];if(t=/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.exec(s))return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16)/255];if(t=/^rgb\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\)$/.exec(s))return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),1];if(t=/^rgba\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([0-9.]+)\)$/.exec(s))return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4],10)];throw new RrdGraphError("Unknow color format '"+s+"'")},RrdGraph.prototype.color2rgba=function(s){return"rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+")"},RrdGraph.prototype.xtr=function(s){return 0===s?(this.xtr_pixie=this.xsize/(this.end-this.start),this.xorigin):this.xorigin+this.xtr_pixie*(s-this.start)},RrdGraph.prototype.ytr=function(s){var t;return isNaN(s)?(this.logarithmic?this.ytr_pixie=this.ysize/(Math.log(this.maxval)/Math.LN10-Math.log(this.minval)/Math.LN10):this.ytr_pixie=this.ysize/(this.maxval-this.minval),t=this.yorigin):t=this.logarithmic?s<this.minval?this.yorigin:this.yorigin-this.ytr_pixie*(Math.log(s)/Math.LN10-Math.log(this.minval)/Math.LN10):this.yorigin-this.ytr_pixie*(s-this.minval),t},RrdGraph.prototype.AlmostEqual2sComplement=function(s,t,i){this.AlmostEqualFloat[0]=s,this.AlmostEqualFloat[1]=t;var e=this.AlmostEqualInt[0];0>e&&(e=2147483648-e);var r=this.AlmostEqualInt[1];0>r&&(r=2147483648-r);var h=Math.abs(e-r);return i>=h},RrdGraph.prototype.tmt2str=function(s){switch(s){case RrdGraph.TMT_SECOND:return"sec";case RrdGraph.TMT_MINUTE:return"min";case RrdGraph.TMT_HOUR:return"hour";case RrdGraph.TMT_DAY:return"day";case RrdGraph.TMT_WEEK:return"week";case RrdGraph.TMT_MONTH:return"mon";case RrdGraph.TMT_YEAR:return"year"}return s},RrdGraph.prototype.find_first_time=function(s,t,i){var e=new Date(1e3*s);switch(t){case RrdGraph.TMT_SECOND:var r=e.getSeconds();r-=r%i,e.setSeconds(r);break;case RrdGraph.TMT_MINUTE:e.setSeconds(0);var h=e.getMinutes();h-=h%i,e.setMinutes(h);break;case RrdGraph.TMT_HOUR:e.setSeconds(0),e.setMinutes(0);var a=e.getHours();a-=a%i,e.setHours(a);break;case RrdGraph.TMT_DAY:e.setSeconds(0),e.setMinutes(0),e.setHours(0);break;case RrdGraph.TMT_WEEK:e.setSeconds(0),e.setMinutes(0),e.setHours(0);var d=e.getDate(),n=e.getDay();d-=n-1,0===n&&(d-=7),e.setDate(d);break;case RrdGraph.TMT_MONTH:e.setSeconds(0),e.setMinutes(0),e.setHours(0),e.setDate(1);var g=e.getMonth();g-=g%i,e.setMonth(g);break;case RrdGraph.TMT_YEAR:e.setSeconds(0),e.setMinutes(0),e.setHours(0),e.setDate(1),e.setMonth(0);var _=e.getFullYear()-1900;_-=(_+1900)%i,e.setFullYear(_+1900)}return Math.round(e.getTime()/1e3)},RrdGraph.prototype.find_next_time=function(s,t,i){var e,r=new Date(1e3*s),h=2;switch(t){case RrdGraph.TMT_SECOND:h=7200;break;case RrdGraph.TMT_MINUTE:h=120;break;case RrdGraph.TMT_HOUR:h=2;break;default:h=2}do{switch(t){case RrdGraph.TMT_SECOND:r.setSeconds(r.getSeconds()+i);break;case RrdGraph.TMT_MINUTE:r.setMinutes(r.getMinutes()+i);break;case RrdGraph.TMT_HOUR:r.setHours(r.getHours()+i);break;case RrdGraph.TMT_DAY:r.setDate(r.getDate()+i);break;case RrdGraph.TMT_WEEK:r.setDate(r.getDate()+7*i);break;case RrdGraph.TMT_MONTH:r.setMonth(r.getMonth()+i);break;case RrdGraph.TMT_YEAR:r.setFullYear(r.getFullYear()+i)}e=Math.round(r.getTime()/1e3)}while(-1===e&&h-- >=0);return e},RrdGraph.prototype.print_calc=function(){for(var s,t,i,e,r,h=0,a=-1,d="",n=(Math.round((new Date).getTime()/1e3),0),g=this.gdes.length;g>n;n++){var _=this.gdes[n].vidx;switch(this.gdes[n].gf){case RrdGraphDesc.GF_PRINT:case RrdGraphDesc.GF_GPRINT:if(this.gdes[_].gf===RrdGraphDesc.GF_VDEF)t=this.gdes[_].vf.val,i=this.gdes[_].vf.when;else{e=(this.gdes[_].end-this.gdes[_].start)/this.gdes[_].step*this.gdes[_].ds_cnt,t=Number.NaN,s=0;for(var o=this.gdes[_].ds;e>o;o+=this.gdes[_].ds_cnt)if(isFinite(this.gdes[_].data[o]))if(isNaN(t))t=this.gdes[_].data[o],s++;else switch(this.gdes[n].cf){case RrdGraphDesc.CF_HWPREDICT:case RrdGraphDesc.CF_MHWPREDICT:case RrdGraphDesc.CF_DEVPREDICT:case RrdGraphDesc.CF_DEVSEASONAL:case RrdGraphDesc.CF_SEASONAL:case RrdGraphDesc.CF_AVERAGE:s++,t+=this.gdes[_].data[o];break;case RrdGraphDesc.CF_MINIMUM:t=Math.min(t,this.gdes[_].data[o]);break;case RrdGraphDesc.CF_FAILURES:case RrdGraphDesc.CF_MAXIMUM:t=Math.max(t,this.gdes[_].data[o]);break;case RrdGraphDesc.CF_LAST:t=this.gdes[_].data[o]}(this.gdes[n].cf===RrdGraphDesc.CF_AVERAGE||this.gdes[n].cf>RrdGraphDesc.CF_LAST)&&s>1&&(t/=s)}if(this.gdes[n].strftm||-1==(r=this.gdes[n].format.indexOf("%S"))){if(!this.gdes[n].strftm&&-1!=this.gdes[n].format.indexOf("%s")){var p=this.auto_scale(t,d,a);t=p[0],d=p[1],a=p[2]}}else{if(0>a){var p=this.auto_scale(t,d,a);t=p[0],d=p[1],a=p[2],0===t&&(a=-1)}else t/=a;this.gdes[n].format=this.gdes[n].format.substr(0,r+1)+"s"+this.gdes[n].format.substr(r+2)}this.gdes[n].strftm?this.gdes[n].legend=strftime(this.gdes[n].format,i):this.gdes[n].legend=sprintf(this.gdes[n].format,t,d),h=1;break;case RrdGraphDesc.GF_LINE:case RrdGraphDesc.GF_AREA:case RrdGraphDesc.GF_TICK:h=1;break;case RrdGraphDesc.GF_HRULE:isNaN(this.gdes[n].yrule)&&(this.gdes[n].yrule=this.gdes[_].vf.val),h=1;break;case RrdGraphDesc.GF_VRULE:0===this.gdes[n].xrule&&(this.gdes[n].xrule=this.gdes[_].vf.when),h=1;break;case RrdGraphDesc.GF_COMMENT:case RrdGraphDesc.GF_TEXTALIGN:case RrdGraphDesc.GF_DEF:case RrdGraphDesc.GF_CDEF:case RrdGraphDesc.GF_VDEF:case RrdGraphDesc.GF_SHIFT:case RrdGraphDesc.GF_XPORT:break;case RrdGraphDesc.GF_STACK:throw new RrdGraphError("STACK should already be turned into LINE or AREA here")}}return h},RrdGraph.prototype.reduce_data=function(s,t){var i,e,r,h,a,d,n,g=Math.ceil(s.step/t),_=0;if(s.step=t*g,n=0,d=0,r=(s.end-s.start)/t,a=s.end%s.step,h=s.start%s.step){for(s.start=s.start-h,_=g-h/t,d+=_*s.ds_cnt,i=0;i<s.ds_cnt;i++)s.data[n++]=Number.NaN;r-=_}if(a&&(s.end=s.end-a+s.step,_=a/t,r-=_),r%g)throw new RrdGraphError("BUG in reduce_data(), SANITY CHECK: "+r+" rows cannot be reduced by "+g);for(e=0;r>=g;e++){for(i=0;i<s.ds_cnt;i++){for(var o=Number.NaN,p=0,l=0;g>l;l++)if(!isNaN(s.data[d+l*s.ds_cnt+i]))if(p++,isNaN(o))o=s.data[d+l*s.ds_cnt+i];else switch(s.cf_reduce){case RrdGraphDesc.CF_HWPREDICT:case RrdGraphDesc.CF_MHWPREDICT:case RrdGraphDesc.CF_DEVSEASONAL:case RrdGraphDesc.CF_DEVPREDICT:case RrdGraphDesc.CF_SEASONAL:case RrdGraphDesc.CF_AVERAGE:o+=s.data[d+l*s.ds_cnt+i];break;case RrdGraphDesc.CF_MINIMUM:o=Math.min(o,s.data[d+l*s.ds_cnt+i]);break;case RrdGraphDesc.CF_FAILURES:case RrdGraphDesc.CF_MAXIMUM:o=Math.max(o,s.data[d+l*s.ds_cnt+i]);break;case RrdGraphDesc.CF_LAST:o=s.data[d+l*s.ds_cnt+i]}if(0===p)o=Number.NaN;else switch(s.cf_reduce){case RrdGraphDesc.CF_HWPREDICT:case RrdGraphDesc.CF_MHWPREDICT:case RrdGraphDesc.CF_DEVSEASONAL:case RrdGraphDesc.CF_DEVPREDICT:case RrdGraphDesc.CF_SEASONAL:case RrdGraphDesc.CF_AVERAGE:o/=p;break;case RrdGraphDesc.CF_MINIMUM:case RrdGraphDesc.CF_FAILURES:case RrdGraphDesc.CF_MAXIMUM:case RrdGraphDesc.CF_LAST:}s.data[n++]=o}d+=s.ds_cnt*g,r-=g}if(a)for(i=0;i<s.ds_cnt;i++)s.data[n++]=Number.NaN},RrdGraph.prototype.data_fetch_async_callback=function(s,t){var i,e;if(i=s.j,e=s["this"],0>t)return-1;e.gdes[i].data_first=1,e.gdes[i].step=Math.max(e.gdes[i].step,e.step),t<e.gdes[i].step?e.reduce_data(e.gdes[i],t):e.gdes[i].step=t,e.data_need_fetch[i]=1;for(var r=0,h=e.gdes.length;h>r;r++)e.data_need_fetch[r]==i+2&&(e.gdes[r].start=e.gdes[i].start,e.gdes[r].end=e.gdes[i].end,e.gdes[r].step=e.gdes[i].step,e.gdes[r].ds_cnt=e.gdes[i].ds_cnt,e.gdes[r].ds_namv=e.gdes[i].ds_namv,e.gdes[r].data=e.gdes[i].data,e.gdes[r].data_first=0,e.data_need_fetch[r]=1);for(var r=0,h=e.gdes.length;h>r;r++)if(!(e.data_need_fetch[r]<0)&&1!=e.data_need_fetch[r])return;for(var r=0,h=e.gdes.length;h>r;r++)if(e.gdes[r].gf==RrdGraphDesc.GF_DEF){for(var a=0;a<e.gdes[r].ds_cnt;a++)if(e.gdes[r].ds_namv[a]===e.gdes[r].ds_nam){e.gdes[r].ds=a;break}if(-1===e.gdes[r].ds)throw new RrdGraphError("No DS called '"+e.gdes[r].ds_nam+"' in '"+e.gdes[r].rrd+"'")}e.graph_paint_draw()},RrdGraph.prototype.data_fetch_async=function(){for(var s=0,t=this.gdes.length;t>s;s++)if(this.gdes[s].gf==RrdGraphDesc.GF_DEF){for(var i=0;s>i;i++)if(this.gdes[i].gf==RrdGraphDesc.GF_DEF&&this.gdes[s].rrd===this.gdes[i].rrd&&this.gdes[s].cf===this.gdes[i].cf&&this.gdes[s].cf_reduce===this.gdes[i].cf_reduce&&this.gdes[s].start_orig===this.gdes[i].start_orig&&this.gdes[s].end_orig===this.gdes[i].end_orig&&this.gdes[s].step_orig===this.gdes[i].step_orig){this.data_need_fetch.push(i+2);break}this.data_need_fetch.push(0)}else this.data_need_fetch.push(-1);for(var s=0,t=this.gdes.length;t>s;s++)0==this.data_need_fetch[s]&&(this.data_need_fetch[s]=this.data.fetch_async(this.gdes[s],this.gdes[s].step,this.data_fetch_async_callback,{"this":this,j:s}))},RrdGraph.prototype.data_fetch=function(){for(var s,t=0,i=this.gdes.length;i>t;t++)if(this.gdes[t].gf==RrdGraphDesc.GF_DEF){s=!1;for(var e=0;t>e&&(this.gdes[e].gf!=RrdGraphDesc.GF_DEF||(this.gdes[t].rrd===this.gdes[e].rrd&&this.gdes[t].cf===this.gdes[e].cf&&this.gdes[t].cf_reduce===this.gdes[e].cf_reduce&&this.gdes[t].start_orig===this.gdes[e].start_orig&&this.gdes[t].end_orig===this.gdes[e].end_orig&&this.gdes[t].step_orig===this.gdes[e].step_orig&&(this.gdes[t].start=this.gdes[e].start,this.gdes[t].end=this.gdes[e].end,this.gdes[t].step=this.gdes[e].step,this.gdes[t].ds_cnt=this.gdes[e].ds_cnt,this.gdes[t].ds_namv=this.gdes[e].ds_namv,this.gdes[t].data=this.gdes[e].data,this.gdes[t].data_first=0,s=!0),!s));e++);if(!s){var r=this.gdes[t].step;if(r=this.data.fetch(this.gdes[t],r),0>r)return-1;this.gdes[t].data_first=1,this.gdes[t].step=Math.max(this.gdes[t].step,this.step),r<this.gdes[t].step?this.reduce_data(this.gdes[t],r):this.gdes[t].step=r}for(var e=0;e<this.gdes[t].ds_cnt;e++)if(this.gdes[t].ds_namv[e]===this.gdes[t].ds_nam){this.gdes[t].ds=e;break}if(-1===this.gdes[t].ds)throw new RrdGraphError("No DS called '"+this.gdes[t].ds_nam+"' in '"+this.gdes[t].rrd+"'")}return 0},RrdGraph.prototype.lcd=function(s){for(var t,i=0;0!=s[i+1];i++){do t=s[i]%s[i+1],s[i]=s[i+1],s[i+1]=t;while(0!=t);s[i+1]=s[i]}return s[i]},RrdGraph.prototype.data_calc=function(){for(var s,t,i=0,e=this.gdes.length;e>i;i++)switch(this.gdes[i].gf){case RrdGraphDesc.GF_XPORT:break;case RrdGraphDesc.GF_SHIFT:var r=this.gdes[this.gdes[i].vidx];r.start-=r.shift,r.end-=r.shift,this.gdes[i].shidx>=0?r.shift=this.gdes[this.gdes[i].shidx].vf.val:r.shift=this.gdes[i].shval,r.shift=r.shift/r.step*r.step,r.start+=r.shift,r.end+=r.shift;break;case RrdGraphDesc.GF_VDEF:if(this.gdes[i].ds_cnt=0,this.gdes[i].vf.calc(this.gdes[this.gdes[i].vidx]))throw new RrdGraphError("Error processing VDEF '"+this.gdes[i].vname+"'");break;case RrdGraphDesc.GF_CDEF:this.gdes[i].ds_cnt=1,this.gdes[i].ds=0,this.gdes[i].data_first=1,this.gdes[i].start=0,this.gdes[i].end=0;var h=[],a=0;s=-1;for(var d=this.gdes[i].rpnp.rpnp,n=0;d[n].op!=RrdRpn.OP_END;n++)if(d[n].op===RrdRpn.OP_VARIABLE||d[n].op===RrdRpn.OP_PREV_OTHER){var g=d[n].ptr;0===this.gdes[g].ds_cnt?(d[n].val=this.gdes[g].vf.val,d[n].op=RrdRpn.OP_NUMBER):(++a,h[a-1]=this.gdes[g].step,this.gdes[i].start<this.gdes[g].start&&(this.gdes[i].start=this.gdes[g].start),(0===this.gdes[i].end||this.gdes[i].end>this.gdes[g].end)&&(this.gdes[i].end=this.gdes[g].end),d[n].data=this.gdes[g].data,d[n].pdata=this.gdes[g].ds,d[n].step=this.gdes[g].step,d[n].ds_cnt=this.gdes[g].ds_cnt)}for(var n=0;d[n].op!=RrdRpn.OP_END;n++)if(d[n].op===RrdRpn.OP_VARIABLE||d[n].op===RrdRpn.OP_PREV_OTHER){var g=d[n].ptr,_=this.gdes[i].start-this.gdes[g].start;_>0&&(d[n].pdata+=_/this.gdes[g].step*this.gdes[g].ds_cnt)}if(null===h)throw new RrdGraphError("rpn expressions without DEF or CDEF variables are not supported");for(h[a]=0,this.gdes[i].step=this.lcd(h),this.gdes[i].data=[],t=this.gdes[i].start+this.gdes[i].step;t<=this.gdes[i].end;t+=this.gdes[i].step)if(-1===this.gdes[i].rpnp.calc(t,this.gdes[i].data,++s))return-1;break;default:continue}return 0},RrdGraph.prototype.data_proc=function(){for(var s,t,i=(this.end-this.start)/this.xsize,e=Number.NaN,r=Number.NaN,h=0,a=this.gdes.length;a>h;h++)this.gdes[h].gf!==RrdGraphDesc.GF_LINE&&this.gdes[h].gf!==RrdGraphDesc.GF_AREA&&this.gdes[h].gf!==RrdGraphDesc.GF_TICK||(this.gdes[h].p_data=[]);for(var h=0;h<this.xsize;h++){var d;t=this.start+i*h,s=0;for(var n=0,a=this.gdes.length;a>n;n++){var g;switch(this.gdes[n].gf){case RrdGraphDesc.GF_LINE:case RrdGraphDesc.GF_AREA:case RrdGraphDesc.GF_TICK:this.gdes[n].stack||(s=0),g=this.gdes[n].yrule,(isNaN(g)||this.gdes[n].gf===RrdGraphDesc.GF_TICK)&&(d=this.gdes[n].vidx,g=this.gdes[d].gf===RrdGraphDesc.GF_VDEF?this.gdes[d].vf.val:t>=this.gdes[d].start&&t<this.gdes[d].end?this.gdes[d].data[Math.floor((t-this.gdes[d].start)/this.gdes[d].step)*this.gdes[d].ds_cnt+this.gdes[d].ds]:Number.NaN),
isNaN(g)?this.gdes[n].p_data[h]=Number.NaN:(s+=g,this.gdes[n].p_data[h]=s,isFinite(s)&&this.gdes[n].gf!=RrdGraphDesc.GF_TICK&&(!(isNaN(e)||e>s)||this.logarithmic&&0>=s||(e=s),(isNaN(r)||s>r)&&(r=s)));break;case RrdGraphDesc.GF_STACK:throw new RrdGraphError("STACK should already be turned into LINE or AREA here")}}}return this.logarithmic?((isNaN(e)||isNaN(r)||0>=r)&&(e=0,r=5.1),0>=e&&(e=r/1e9)):(isNaN(e)||isNaN(r))&&(e=0,r=1),(isNaN(this.minval)||!this.rigid&&this.minval>e)&&(this.logarithmic?this.minval=e/2:this.minval=e),(isNaN(this.maxval)||!this.rigid&&this.maxval<r)&&(this.logarithmic?this.maxval=2*r:this.maxval=r),this.minval>this.maxval&&(this.minval>0?this.minval=.99*this.maxval:this.minval=1.01*this.maxval),this.AlmostEqual2sComplement(this.minval,this.maxval,4)&&(this.maxval>0?this.maxval*=1.01:this.maxval*=.99,this.AlmostEqual2sComplement(this.maxval,0,4)&&(this.maxval=1)),0},RrdGraph.prototype.leg_place=function(s){var t,i,e,r,h,a,d=1.5*this.TEXT.LEGEND.size,n=1.5*this.TEXT.LEGEND.size,g=0,_=0,o=n,p=0,l=0,c=0,R=0,f=RrdGraphDesc.TXA_JUSTIFIED;if(i=s?0:this.legendwidth-2*n,!this.no_legend&&!this.only_graph){h=[];for(var G=0,E=this.gdes.length;E>G;G++){var T;if(s&&(a=this.gdes[G].legend),t=g,this.gdes[G].gf===RrdGraphDesc.GF_TEXTALIGN&&(f=this.gdes[G].txtalign),this.force_rules_legend||(this.gdes[G].gf===RrdGraphDesc.GF_HRULE&&(this.gdes[G].yrule<this.minval||this.gdes[G].yrule>this.maxval)&&(this.gdes[G].legend=null),this.gdes[G].gf===RrdGraphDesc.GF_VRULE&&(this.gdes[G].xrule<this.start||this.gdes[G].xrule>this.end)&&(this.gdes[G].legend=null)),null!=this.gdes[G].legend?(this.gdes[G].legend=this.gdes[G].legend.replace(/\\t/gi,"	"),e=this.gdes[G].legend.length):e=0,e>=2&&"\\"===this.gdes[G].legend.charAt(e-2)?(T=this.gdes[G].legend.charAt(e-1),e-=2,this.gdes[G].legend=this.gdes[G].legend.substr(0,e)):T=null,"l"!=T&&"n"!=T&&"r"!=T&&"j"!=T&&"c"!=T&&"."!=T&&"u"!=T&&"s"!=T&&null!=T&&"g"!=T)throw new RrdGraphError("Unknown control code at the end of "+this.gdes[G].legend+": "+T);for("n"===T&&(T="l"),"."===T&&(T="\x00");"g"===T&&e>0&&" "===this.gdes[G].legend.charAt(e-1);)e--,this.gdes[G].legend=this.gdes[G].legend.substr(0,e);if(0!=e?(h[G]="g"===T?0:d,g>0&&(g+=h[G]),g+=this.gfx.get_text_width(g+n,this.TEXT.LEGEND,this.tabwidth,this.gdes[G].legend),_++):h[G]=0,"g"===T&&(T=null),null===T){if(s&&g>i&&(i=g),G===E-1||g>i)switch(f){case RrdGraphDesc.TXA_RIGHT:T="r";break;case RrdGraphDesc.TXA_CENTER:T="c";break;case RrdGraphDesc.TXA_JUSTIFIED:T="j";break;default:T="l"}g>i&&_>1&&(G--,g=t,_--),1===_&&"j"===T&&(T="l")}if(null!=T){for(o=n,c=_>=2&&"j"===T?(i-g)/(_-1):0,"c"===T&&(o=n+(i-g)/2),"r"===T&&(o=i-g+n),r=R;G>=r;r++)""!==this.gdes[r].legend&&(this.gdes[r].leg_x=o,this.gdes[r].leg_y=p+n,o+=this.gfx.get_text_width(o,this.TEXT.LEGEND,this.tabwidth,this.gdes[r].legend)+h[r]+c);l=p,(o>n||"s"===T)&&(p+=1.4*this.TEXT.LEGEND.size),"s"===T&&(p-=this.TEXT.LEGEND.size),"u"===T&&(p-=1.4*this.TEXT.LEGEND.size),s&&g>i&&(i=g),g=0,_=0,R=r}s&&(this.gdes[G].legend=a)}s?this.legendwidth=i+2*n:this.legendheight=p+.6*n}return 0},RrdGraph.prototype.axis_paint=function(){this.gfx.line(this.xorigin-4,this.yorigin,this.xorigin+this.xsize+4,this.yorigin,this.MGRIDWIDTH,this.GRC.AXIS),this.gfx.line(this.xorigin,this.yorigin+4,this.xorigin,this.yorigin-this.ysize-4,this.MGRIDWIDTH,this.GRC.AXIS),this.gfx.new_area(this.xorigin+this.xsize+2,this.yorigin-3,this.xorigin+this.xsize+2,this.yorigin+3,this.xorigin+this.xsize+7,this.yorigin,this.GRC.ARROW),this.gfx.close_path(),this.gfx.new_area(this.xorigin-3,this.yorigin-this.ysize-2,this.xorigin+3,this.yorigin-this.ysize-2,this.xorigin,this.yorigin-this.ysize-7,this.GRC.ARROW),this.gfx.close_path(),0!=this.second_axis_scale&&(this.gfx.line(this.xorigin+this.xsize,this.yorigin+4,this.xorigin+this.xsize,this.yorigin-this.ysize-4,this.MGRIDWIDTH,this.GRC.AXIS),this.gfx.new_area(this.xorigin+this.xsize-2,this.yorigin-this.ysize-2,this.xorigin+this.xsize+3,this.yorigin-this.ysize-2,this.xorigin+this.xsize,this.yorigin-this.ysize-7,this.GRC.ARROW),this.gfx.close_path())},RrdGraph.prototype.frexp10=function(s){var t,i;return i=Math.floor(Math.log(Math.abs(s))/Math.LN10),t=s/Math.pow(10,i),t>=10&&(i++,t=s/Math.pow(10,i)),[t,i]},RrdGraph.prototype.horizontal_log_grid=function(){var s,t,i,e,r,h,a,d,n,g,_,o,p,l,c,R=[[1,10,0,0,0,0,0,0,0,0],[1,5,10,0,0,0,0,0,0,0],[1,2,5,7,10,0,0,0,0,0],[1,2,4,6,8,10,0,0,0,0],[1,2,3,4,5,6,7,8,9,10],[0,0,0,0,0,0,0,0,0,0]],f=1,G=-1;for(r=Math.log(this.maxval/this.minval)/Math.LN10,h=this.ysize/r;h*f<2.3*this.TEXT.LEGEND.size;)1===f?f=2.3:f+=2.3;do{for(G++,s=0;R[G][s+1]<10;s++);a=h*Math.log(10/R[G][s])/Math.LN10}while(a>1.56*this.TEXT.LEGEND.size&&R[G][0]>0);G&&G--,d=-1;do{var E;d++;var T=this.frexp10(this.minval);E=T[0],g=T[1]}while(R[G][d]<10&&E>R[G][d]);for(10===R[G][d]&&(g+=1,d=0),i=g,i%f&&(i+=Math.abs(-i%f)),o=this.xorigin,p=this.xorigin+this.xsize,_=Number.NAN;;){if(n=R[G][d]*Math.pow(10,i),this.AlmostEqual2sComplement(n,_,4))break;if(_=n,l=this.ytr(n),Math.floor(l+.5)<=this.yorigin-this.ysize)break;if(this.gfx.line(o-2,l,o,l,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.line(p,l,p+2,l,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.dashed_line(o-2,l,p+2,l,this.MGRIDWIDTH,this.GRC.MGRID,this.grid_dash_on,this.grid_dash_off),this.force_units_si){var D,m,x;D=Math.floor(i/3),m=n>=1?Math.pow(10,i%3):Math.pow(10,(i+1)%3+2),m*=R[G][d],x=D+this.si_symbcenter<this.si_symbol.length&&D+this.si_symbcenter>=0?this.si_symbol[D+this.si_symbcenter]:"?",c=sprintf("%3.0f %s",m,x)}else c=sprintf("%3.0e",n);if(0!=this.second_axis_scale){var u,F=n*this.second_axis_scale+this.second_axis_shift;if(this.second_axis_format[0])u=sprintf(this.second_axis_format,F,"");else if(this.force_units_si){var N=1,M="",T=this.auto_scale(F,M,N);F=T[0],M=T[1],N=T[2],u=sprintf("%4.0f %s",F,M)}else u=sprintf("%3.0e",F);this.gfx.text(p+7,l,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_LEFT,RrdGraph.GFX_V_CENTER,u)}if(this.gfx.text(o-this.TEXT.AXIS.size,l,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_RIGHT,RrdGraph.GFX_V_CENTER,c),4>G&&1===f){if(0===d){for(e=i-1,s=1;R[G][s]<10;s++);s=R[G][s-1]+1,t=10}else e=i,s=R[G][d-1]+1,t=R[G][d];for(;t>s;s++)if(n=s*Math.pow(10,e),!(n<this.minval)){if(l=this.ytr(n),Math.floor(l+.5)<=this.yorigin-this.ysize)break;this.gfx.line(o-2,l,o,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(p,l,p+2,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(o-1,l,p+1,l,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off)}}else if(f>1)for(s=i-f/3*2;i>s;s+=f/3)if(n=Math.pow(10,s),!(n<this.minval)){if(l=this.ytr(n),Math.floor(l+.5)<=this.yorigin-this.ysize)break;this.gfx.line(o-2,l,o,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(p,l,p+2,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(o-1,l,p+1,l,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off)}10===R[G][++d]&&(d=0,i+=f)}if(4>G&&1===f){if(0===d){for(e=i-1,s=1;R[G][s]<10;s++);s=R[G][s-1]+1,t=10}else e=i,s=R[G][d-1]+1,t=R[G][d];for(;t>s;s++)if(n=s*Math.pow(10,e),!(n<this.minval)){if(l=this.ytr(n),Math.floor(l+.5)<=this.yorigin-this.ysize)break;this.gfx.line(o-2,l,o,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(p,l,p+2,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(o-1,l,p+1,l,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off)}}else if(f>1)for(s=i-f/3*2;i>s;s+=f/3)if(n=Math.pow(10,s),!(n<this.minval)){if(l=this.ytr(n),Math.floor(l+.5)<=this.yorigin-this.ysize)break;this.gfx.line(o-2,l,o,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(p,l,p+2,l,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(o-1,l,p+1,l,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off)}return 1},RrdGraph.prototype.vertical_grid=function(){var s,t,i,e,r,h,a,d,n;if(-1===this.xlab_user.minsec){for(r=(this.end-this.start)/this.xsize,s=0;-1!=this.xlab[s+1].minsec&&this.xlab[s+1].minsec<=r;)s++;for(0===s&&(s=1);this.xlab[s-1].minsec===this.xlab[s].minsec&&this.xlab[s].length>this.end-this.start;)s--;this.xlab_user=this.xlab[s]}if(d=this.yorigin,n=this.yorigin-this.ysize,!this.no_minor)for(t=this.find_first_time(this.start,this.xlab_user.gridtm,this.xlab_user.gridst),e=this.find_first_time(this.start,this.xlab_user.mgridtm,this.xlab_user.mgridst);t<this.end&&-1!=t;t=this.find_next_time(t,this.xlab_user.gridtm,this.xlab_user.gridst))if(!(t<this.start||t>this.end)){for(;t>e&&-1!=e;)e=this.find_next_time(e,this.xlab_user.mgridtm,this.xlab_user.mgridst);if(-1===e)break;t!==e&&(a=this.xtr(t),this.gfx.line(a,n-2,a,n,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(a,d,a,d+2,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(a,d+1,a,n-1,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off))}for(t=this.find_first_time(this.start,this.xlab_user.mgridtm,this.xlab_user.mgridst);t<this.end&&-1!=t;t=this.find_next_time(t,this.xlab_user.mgridtm,this.xlab_user.mgridst))t<this.start||t>this.end||(a=this.xtr(t),this.gfx.line(a,n-2,a,n,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.line(a,d,a,d+3,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.dashed_line(a,d+3,a,n-2,this.MGRIDWIDTH,this.GRC.MGRID,this.grid_dash_on,this.grid_dash_off));for(t=this.find_first_time(this.start-this.xlab_user.precis/2,this.xlab_user.labtm,this.xlab_user.labst);t<=this.end-this.xlab_user.precis/2&&-1!=t;t=this.find_next_time(t,this.xlab_user.labtm,this.xlab_user.labst))i=t+this.xlab_user.precis/2,i<this.start||i>this.end||(h=strftime(this.xlab_user.stst,i),this.gfx.text(this.xtr(i),d+3,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_TOP,h))},RrdGraph.prototype.auto_scale=function(s,t,i){var e;return 0===s||isNaN(s)?(e=0,i=1):(e=Math.floor(Math.log(Math.abs(s))/Math.LN10/(Math.log(this.base)/Math.LN10)),i=Math.pow(this.base,e),s/=i),t=e<=this.si_symbcenter&&e>=-this.si_symbcenter?this.si_symbol[e+this.si_symbcenter]:"?",[s,t,i]},RrdGraph.prototype.si_unit=function(){var s,t=0;s=Math.floor(Math.log(Math.max(Math.abs(this.minval),Math.abs(this.maxval)))/Math.log(this.base)),t=9999!=this.unitsexponent?Math.floor(this.unitsexponent/3):s,this.magfact=Math.pow(this.base,s),this.viewfactor=this.magfact/Math.pow(this.base,t),t+this.si_symbcenter<this.si_symbol.length&&t+this.si_symbcenter>=0?this.symbol=this.si_symbol[t+this.si_symbcenter]:this.symbol="?"},RrdGraph.prototype.expand_range=function(){var s,t,i,e,r=[1e3,900,800,750,700,600,500,400,300,250,200,125,100,90,80,75,70,60,50,40,30,25,20,10,9,8,7,6,5,4,3.5,3,2.5,2,1.8,1.5,1.2,1,.8,.7,.6,.5,.4,.3,.2,.1,0,-1];if(isNaN(this.ygridstep))if(this.alt_autoscale){var h,a;h=this.maxval-this.minval,i=.1*h,a=2*Math.pow(10,Math.floor(Math.log(Math.max(Math.abs(this.minval),Math.abs(this.maxval))/this.magfact)/Math.LN10)-2),a>h&&(i=.55*(a-h)),this.minval-=i,this.maxval+=i}else if(this.alt_autoscale_min)i=.1*(this.maxval-this.minval),this.minval-=i;else if(this.alt_autoscale_max)i=.1*(this.maxval-this.minval),this.maxval+=i;else for(s=this.minval/this.magfact,t=this.maxval/this.magfact,e=1;r[e]>0;e++)r[e-1]>=s&&r[e]<=s&&(this.minval=r[e]*this.magfact),-r[e-1]<=s&&-r[e]>=s&&(this.minval=-r[e-1]*this.magfact),r[e-1]>=t&&r[e]<=t&&(this.maxval=r[e-1]*this.magfact),-r[e-1]<=t&&-r[e]>=t&&(this.maxval=-r[e]*this.magfact);else this.minval=this.ylabfact*this.ygridstep*Math.floor(this.minval/(this.ylabfact*this.ygridstep)),this.maxval=this.ylabfact*this.ygridstep*Math.ceil(this.maxval/(this.ylabfact*this.ygridstep))},RrdGraph.prototype.calc_horizontal_grid=function(){var s,t,i,e,r,h,a=0;if(this.ygrid_scale.labfact=2,s=this.maxval-this.minval,t=s/this.magfact,isNaN(t)||!isFinite(t))return!1;if(i=1,isNaN(this.ygridstep))if(this.alt_ygrid)if(r=Math.ceil(Math.log(Math.max(Math.abs(this.maxval),Math.abs(this.minval))*this.viewfactor/this.magfact)/Math.LN10),0>=r&&(r=1),this.ygrid_scale.gridstep=Math.pow(10,Math.floor(Math.log(s*this.viewfactor/this.magfact)/Math.LN10))/this.viewfactor*this.magfact,0===this.ygrid_scale.gridstep&&(this.ygrid_scale.gridstep=.1),s/this.ygrid_scale.gridstep<5&&this.ygrid_scale.gridstep>=30&&(this.ygrid_scale.gridstep/=10),s/this.ygrid_scale.gridstep>15&&(this.ygrid_scale.gridstep*=10),s/this.ygrid_scale.gridstep>5?(this.ygrid_scale.labfact=1,(s/this.ygrid_scale.gridstep>8||this.ygrid_scale.gridstep<1.8*this.TEXT.AXIS.size)&&(this.ygrid_scale.labfact=2)):(this.ygrid_scale.gridstep/=5,this.ygrid_scale.labfact=5),h=Math.floor(Math.log(this.ygrid_scale.gridstep*this.ygrid_scale.labfact*this.viewfactor/this.magfact)/Math.LN10),0>h){var d=r-h+1;this.unitslength<d+2&&(this.unitslength=d+2),this.ygrid_scale.labfmt=sprintf("%%d.%df%s",d,-h," "!=this.symbol?" %s":"")}else{var d=r+1;this.unitslength<d+2&&(this.unitslength=d+2),this.ygrid_scale.labfmt=sprintf("%%d.0f%s",d," "!=this.symbol?" %s":"")}else{for(e=0;this.ylab[e].grid>0&&(i=this.ysize/(t/this.ylab[e].grid),a=e,!(i>=5));e++);for(e=0;4>e;e++)if(i*this.ylab[a].lfac[e]>=1.8*this.TEXT.AXIS.size){this.ygrid_scale.labfact=this.ylab[a].lfac[e];break}this.ygrid_scale.gridstep=this.ylab[a].grid*this.magfact}else this.ygrid_scale.gridstep=this.ygridstep,this.ygrid_scale.labfact=this.ylabfact;return!0},RrdGraph.prototype.draw_horizontal_grid=function(){var s,t,i,e,r,h,a,d=0,n=this.xorigin,g=this.xorigin+this.xsize,_=Math.round(this.minval/this.ygrid_scale.gridstep-1),o=Math.round(this.maxval/this.ygrid_scale.gridstep+1),p=0,l="";for(t=this.ygrid_scale.gridstep/this.magfact*this.viewfactor,e=t*o,s=_;o>=s;s++)if(r=this.ytr(this.ygrid_scale.gridstep*s),h=this.ytr(this.ygrid_scale.gridstep*(s+1)),Math.floor(r+.5)>=this.yorigin-this.ysize&&Math.floor(r+.5)<=this.yorigin)if(s%this.ygrid_scale.labfact===0||1===d&&(h<this.yorigin-this.ysize||h>this.yorigin)){if(" "===this.symbol?i=this.alt_ygrid?sprintf(this.ygrid_scale.labfmt,t*s):10>e?sprintf("%4.1f",t*s):sprintf("%4.0f",t*s):(a=0===s?" ":this.symbol,i=this.alt_ygrid?sprintf(this.ygrid_scale.labfmt,t*s,a):10>e?sprintf("%4.1f %s",t*s,a):sprintf("%4.0f %s",t*s,a)),d++,0!=this.second_axis_scale){var c,R=this.ygrid_scale.gridstep*s*this.second_axis_scale+this.second_axis_shift;if(this.second_axis_format)c=sprintf(this.second_axis_format,R);else{if(!p){var f=this.ygrid_scale.gridstep*(_+o)/2*this.second_axis_scale+this.second_axis_shift;f=this.auto_scale(f,l,p),l=f[1],p=f[2]}R/=p,c=10>e?sprintf("%5.1f %s",R,l):sprintf("%5.0f %s",R,l)}this.gfx.text(g+7,r,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_LEFT,RrdGraph.GFX_V_CENTER,c)}this.gfx.text(n-this.TEXT.AXIS.size,r,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_RIGHT,RrdGraph.GFX_V_CENTER,i),this.gfx.line(n-2,r,n,r,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.line(g,r,g+2,r,this.MGRIDWIDTH,this.GRC.MGRID),this.gfx.dashed_line(n-2,r,g+2,r,this.MGRIDWIDTH,this.GRC.MGRID,this.grid_dash_on,this.grid_dash_off)}else this.no_minor||(this.gfx.line(n-2,r,n,r,this.GRIDWIDTH,this.GRC.GRID),this.gfx.line(g,r,g+2,r,this.GRIDWIDTH,this.GRC.GRID),this.gfx.dashed_line(n-1,r,g+1,r,this.GRIDWIDTH,this.GRC.GRID,this.grid_dash_on,this.grid_dash_off));return 1},RrdGraph.prototype.grid_paint=function(){var s,t,i,e=0;if(this.draw_3d_border>0&&(s=this.draw_3d_border,this.gfx.new_area(0,this.yimg,s,this.yimg-s,s,s,this.GRC.SHADEA),this.gfx.add_point(this.ximg-s,s),this.gfx.add_point(this.ximg,0),this.gfx.add_point(0,0),this.gfx.close_path(),this.gfx.new_area(s,this.yimg-s,this.ximg-s,this.yimg-s,this.ximg-s,s,this.GRC.SHADEB),this.gfx.add_point(this.ximg,0),this.gfx.add_point(this.ximg,this.yimg),this.gfx.add_point(0,this.yimg),this.gfx.close_path()),this.draw_x_grid&&this.vertical_grid(),this.draw_y_grid&&(e=this.logarithmic?this.horizontal_log_grid():this.draw_horizontal_grid(),e||this.gfx.text(this.ximg/2,(2*this.yorigin-this.ysize)/2,this.GRC.FONT,this.TEXT.AXIS,this.tabwidth,0,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_CENTER,"No Data found")),this.ylegend&&this.gfx.text(this.xOriginLegendY+10,this.yOriginLegendY,this.GRC.FONT,this.TEXT.UNIT,this.tabwidth,this.YLEGEND_ANGLE,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_CENTER,this.ylegend),this.second_axis_legend&&this.gfx.text(this.xOriginLegendY2+10,this.yOriginLegendY2,this.GRC.FONT,this.TEXT.UNIT,this.tabwidth,this.YLEGEND_ANGLE,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_CENTER,this.second_axis_legend),this.gfx.text(this.xOriginTitle,this.yOriginTitle+6,this.GRC.FONT,this.TEXT.TITLE,this.tabwidth,0,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_TOP,this.title),!this.no_rrdtool_tag){var r=this.parse_color(this.GRC.FONT);r[3]=.3;var h=this.color2rgba(r),a=this.legendposition===RrdGraph.LEGEND_POS_EAST?this.xOriginLegendY:this.ximg-4;this.gfx.text(a,5,h,this.TEXT.WATERMARK,this.tabwidth,-90,RrdGraph.GFX_H_LEFT,RrdGraph.GFX_V_TOP,"RRDTOOL / TOBI OETIKER")}if(this.watermark){var r=this.parse_color(this.GRC.FONT);r[3]=.3;var h=this.color2rgba(r);this.gfx.text(this.ximg/2,this.yimg-6,h,this.TEXT.WATERMARK,this.tabwidth,0,RrdGraph.GFX_H_CENTER,RrdGraph.GFX_V_BOTTOM,this.watermark)}if(!this.no_legend&&!this.only_graph)for(var s=0,d=this.gdes.length;d>s;s++)if(this.gdes[s].legend&&(t=this.xOriginLegend+this.gdes[s].leg_x,i=this.legenddirection===RrdGraph.LEGEND_DIR_TOP_DOWN?this.yOriginLegend+this.gdes[s].leg_y:this.yOriginLegend+this.legendheight-this.gdes[s].leg_y,this.gfx.text(t,i,this.GRC.FONT,this.TEXT.LEGEND,this.tabwidth,0,RrdGraph.GFX_H_LEFT,RrdGraph.GFX_V_BOTTOM,this.gdes[s].legend),this.gdes[s].gf!=RrdGraphDesc.GF_PRINT&&this.gdes[s].gf!=RrdGraphDesc.GF_GPRINT&&this.gdes[s].gf!=RrdGraphDesc.GF_COMMENT)){var n,g;n=1.2*this.gfx.get_text_width(0,this.TEXT.LEGEND,this.tabwidth,"o"),g=n,i-=.4*g,this.dynamic_labels&&this.gdes[s].gf===RrdGraphDesc.GF_HRULE?this.gfx.line(t,i-g/2,t+n,i-g/2,1,this.gdes[s].col):this.dynamic_labels&&this.gdes[s].gf===RrdGraphDesc.GF_VRULE?this.gfx.line(t+n/2,i,t+n/2,i-g,1,this.gdes[s].col):this.dynamic_labels&&this.gdes[s].gf===RrdGraphDesc.GF_LINE?this.gfx.line(t,i,t+n,i-g,this.gdes[s].linewidth,this.gdes[s].col):(this.gfx.new_area(t,i-g,t,i,t+n,i,this.GRC.BACK),this.gfx.add_point(t+n,i-g),this.gfx.close_path(),this.gfx.new_area(t,i-g,t,i,t+n,i,this.gdes[s].col),this.gfx.add_point(t+n,i-g),this.gfx.close_path(),this.gdes[s].dash&&this.gfx.set_dash([3],1,0),this.gfx.rectangle(t,i,t+n,i-g,1,this.GRC.FRAME))}},RrdGraph.prototype.graph_size_location=function(s){var t=0,i=0,e=0,r=0,h=0,a=0,d=0,n=15,g=15,_=4;if(this.only_graph)return this.xorigin=0,this.ximg=this.xsize,this.yimg=this.ysize,this.yorigin=this.ysize,this.xtr(0),this.ytr(Number.NaN),0;if(this.watermark&&(_=1.5*this.TEXT.WATERMARK.size),this.ylegend&&(t=1.5*this.TEXT.UNIT.size),i=this.second_axis_legend?1.5*this.TEXT.UNIT.size:n,e=this.title?1.95*this.TEXT.TITLE.size+10:g,s&&(this.draw_x_grid&&(d=1.35*this.TEXT.AXIS.size),(this.draw_y_grid||this.forceleftspace)&&(r=this.gfx.get_text_width(0,this.TEXT.AXIS,this.tabwidth,"0")*this.unitslength)),r+=n,this.legendheight=0,this.legendwidth=0,!this.no_legend&&(this.legendposition===RrdGraph.LEGEND_POS_WEST||this.legendposition===RrdGraph.LEGEND_POS_EAST)&&-1===this.leg_place(1))return-1;if(this.full_size_mode){if(this.ximg=this.xsize,this.yimg=this.ysize,h=this.ximg,a=this.yimg,h-=r,this.legendposition!==RrdGraph.LEGEND_POS_WEST&&this.legendposition!==RrdGraph.LEGEND_POS_EAST||this.no_legend||(h-=this.legendwidth),0!=this.second_axis_scale&&(h-=r),this.no_rrdtool_tag||(h-=n),h-=t+i,1>h&&(h=1),this.xsize=h,!this.no_legend&&(this.legendposition===RrdGraph.LEGEND_POS_NORTH||this.legendposition===RrdGraph.LEGEND_POS_SOUTH)&&(this.legendwidth=this.ximg,-1===this.leg_place(0)))return-1;a-=this.legendposition!==RrdGraph.LEGEND_POS_NORTH&&this.legendposition!==RrdGraph.LEGEND_POS_SOUTH||this.no_legend?d:d+this.legendheight,a-=e,this.nolegened&&(a-=.5*g),this.watermark&&(a-=_),1>a&&(a=1),this.ysize=a}else{if(s&&(h=this.xsize,a=this.ysize),this.ximg=h+r,this.no_rrdtool_tag||(this.ximg+=n),this.legendposition!==RrdGraph.LEGEND_POS_WEST&&this.legendposition!==RrdGraph.LEGEND_POS_EAST||this.no_legend||(this.ximg+=this.legendwidth),0!=this.second_axis_scale&&(this.ximg+=r),this.ximg+=t+i,!this.no_legend&&(this.legendposition===RrdGraph.LEGEND_POS_NORTH||this.legendposition===RrdGraph.LEGEND_POS_SOUTH)&&(this.legendwidth=this.ximg,-1===this.leg_place(0)))return-1;this.yimg=a+d,this.legendposition!==RrdGraph.LEGEND_POS_NORTH&&this.legendposition!==RrdGraph.LEGEND_POS_SOUTH||this.no_legend||(this.yimg+=this.legendheight),e?this.yimg+=e:this.yimg+=1.5*g,this.no_legend&&(this.yimg+=.5*g),this.watermark&&(this.yimg+=_)}if(!this.no_legend&&(this.legendposition===RrdGraph.LEGEND_POS_WEST||this.legendposition===RrdGraph.LEGEND_POS_EAST)&&-1===this.leg_place(0))return-1;switch(this.legendposition){case RrdGraph.LEGEND_POS_NORTH:this.xOriginTitle=Math.round(this.xsize/2),this.yOriginTitle=0,this.xOriginLegend=0,this.yOriginLegend=Math.round(e),this.xOriginLegendY=0,this.yOriginLegendY=Math.round(e+this.legendheight+a/2+d),this.xorigin=Math.round(t+r),this.yorigin=Math.round(e+this.legendheight+a),this.xOriginLegendY2=Math.round(t+r+h),0!=this.second_axis_scale&&(this.xOriginLegendY2+=r),this.yOriginLegendY2=Math.round(e+this.legendheight+a/2+d);break;case RrdGraph.LEGEND_POS_WEST:this.xOriginTitle=Math.round(this.legendwidth+this.xsize/2),this.yOriginTitle=0,this.xOriginLegend=0,this.yOriginLegend=Math.round(e),this.xOriginLegendY=Math.round(this.legendwidth),this.yOriginLegendY=Math.round(e+a/2),this.xorigin=Math.round(this.legendwidth+t+r),this.yorigin=Math.round(e+a),this.xOriginLegendY2=Math.round(this.legendwidth+t+r+h),0!=this.second_axis_scale&&(this.xOriginLegendY2+=r),this.yOriginLegendY2=Math.round(e+a/2);break;case RrdGraph.LEGEND_POS_SOUTH:this.xOriginTitle=Math.round(this.xsize/2),this.yOriginTitle=0,this.xOriginLegend=0,this.yOriginLegend=Math.round(e+a+d),this.xOriginLegendY=0,this.yOriginLegendY=Math.round(e+a/2),this.xorigin=Math.round(t+r),this.yorigin=Math.round(e+a),this.xOriginLegendY2=Math.round(t+r+h),0!=this.second_axis_scale&&(this.xOriginLegendY2+=r),this.yOriginLegendY2=Math.round(e+a/2);break;case RrdGraph.LEGEND_POS_EAST:this.xOriginTitle=Math.round(this.xsize/2),this.yOriginTitle=0,this.xOriginLegend=Math.round(t+r+h+i),0!=this.second_axis_scale&&(this.xOriginLegend+=r),this.yOriginLegend=Math.round(e),this.xOriginLegendY=0,this.yOriginLegendY=Math.round(e+a/2),this.xorigin=Math.round(t+r),this.yorigin=Math.round(e+a),this.xOriginLegendY2=Math.round(t+r+h),0!=this.second_axis_scale&&(this.xOriginLegendY2+=r),this.yOriginLegendY2=Math.round(e+a/2),this.no_rrdtool_tag||(this.xOriginTitle+=n,this.xOriginLegend+=n,this.xOriginLegendY+=n,this.xorigin+=n,this.xOriginLegendY2+=n)}return this.xtr(0),this.ytr(Number.NaN),0},RrdGraph.prototype.graph_paint_init=function(){if(this.logarithmic&&this.minval<=0)throw new RrdGraphError("for a logarithmic yaxis you must specify a lower-limit > 0");if(this.start<31536e4)throw new RrdGraphError("the first entry to fetch should be after 1980 ("+this.start+")");if(this.end<this.start)throw new RrdGraphError("start ("+this.start+") should be less than end ("+this.end+")");this.xlab_user={minsec:-1,length:0,gridtm:0,gridst:0,mgridtm:0,mgridst:0,labtm:0,labst:0,precis:0,stst:null},this.ygrid_scale={gridstep:0,labfact:0,labfmt:null},this.minval=this.setminval,this.maxval=this.setmaxval,this.step=Math.max(this.step_orig,(this.end-this.start)/this.xsize);for(var s=0,t=this.gdes.length;t>s;s++)this.gdes[s].step=this.gdes[s].step_orig,this.gdes[s].start=this.start,this.gdes[s].end=this.end},RrdGraph.prototype.graph_paint_draw=function(){var s=0,t=null;if(-1===this.data_calc())return-1;var i=this.print_calc();if(0>i)return-1;if(-1===this.graph_size_location(i))return-1;if(-1===this.data_proc())return-1;if(this.logarithmic||this.si_unit(),this.rigid||this.logarithmic||this.expand_range(),0===this.magfact&&(this.magfact=1),!this.calc_horizontal_grid())return-1;this.ytr(Number.NaN),this.gfx.size(this.ximg,this.yimg),this.gfx.new_area(0,0,0,this.yimg,this.ximg,this.yimg,this.GRC.BACK),this.gfx.add_point(this.ximg,0),this.gfx.close_path(),this.gfx.new_area(this.xorigin,this.yorigin,this.xorigin+this.xsize,this.yorigin,this.xorigin+this.xsize,this.yorigin-this.ysize,this.GRC.CANVAS),this.gfx.add_point(this.xorigin,this.yorigin-this.ysize),this.gfx.close_path(),this.minval>0&&(s=this.minval),this.maxval<0&&(s=this.maxval);for(var i=0,e=this.gdes.length;e>i;i++)switch(this.gdes[i].gf){case RrdGraphDesc.GF_CDEF:case RrdGraphDesc.GF_VDEF:case RrdGraphDesc.GF_DEF:case RrdGraphDesc.GF_PRINT:case RrdGraphDesc.GF_GPRINT:case RrdGraphDesc.GF_COMMENT:case RrdGraphDesc.GF_TEXTALIGN:case RrdGraphDesc.GF_HRULE:case RrdGraphDesc.GF_VRULE:case RrdGraphDesc.GF_XPORT:case RrdGraphDesc.GF_SHIFT:break;case RrdGraphDesc.GF_TICK:for(var r=0;r<this.xsize;r++)isNaN(this.gdes[i].p_data[r])||0==this.gdes[i].p_data[r]||(this.gdes[i].yrule>0?this.gfx.line(this.xorigin+r,this.yorigin+1,this.xorigin+r,this.yorigin-this.gdes[i].yrule*this.ysize,1,this.gdes[i].col):this.gdes[i].yrule<0&&this.gfx.line(this.xorigin+r,this.yorigin-this.ysize-1,this.xorigin+r,this.yorigin-this.ysize-this.gdes[i].yrule*this.ysize,1,this.gdes[i].col));break;case RrdGraphDesc.GF_LINE:case RrdGraphDesc.GF_AREA:for(var h=this.maxval-this.minval,a=this.maxval+9*h,d=this.minval-9*h,r=0;r<this.xsize;r++)isNaN(this.gdes[i].p_data[r])||(isFinite(this.gdes[i].p_data[r])||(this.gdes[i].p_data[r]>0?this.gdes[i].p_data[r]=this.maxval:this.gdes[i].p_data[r]=this.minval),this.gdes[i].p_data[r]>a&&(this.gdes[i].p_data[r]=a),this.gdes[i].p_data[r]<d&&(this.gdes[i].p_data[r]=d));var n=this.parse_color(this.gdes[i].col);if(0!=n[3])if(this.gdes[i].gf===RrdGraphDesc.GF_LINE){var g=0,_=!1;this.gdes[i].dash&&this.gfx.set_dash(this.gdes[i].p_dashes,this.gdes[i].ndash,this.gdes[i].offset),this.gfx.stroke_begin(this.gdes[i].linewidth,this.gdes[i].col);for(var r=1;r<this.xsize;r++)if(isNaN(this.gdes[i].p_data[r])||this.slopemode&&isNaN(this.gdes[i].p_data[r-1]))_=!1;else if(_){var o=r+this.xorigin,p=this.ytr(this.gdes[i].p_data[r]);if(!this.slopemode&&!this.AlmostEqual2sComplement(p,g,4)){var l=r-1+this.xorigin,c=p;this.gfx.lineTo(l,c)}g=p,this.gfx.lineTo(o,p)}else{if(g=this.ytr(this.gdes[i].p_data[r]),this.slopemode){var l=r-1+this.xorigin,c=this.ytr(this.gdes[i].p_data[r-1]);this.gfx.moveTo(l,c),l=r+this.xorigin,c=g,this.gfx.lineTo(l,c)}else{var l=r-1+this.xorigin,c=g;this.gfx.moveTo(l,c),l=r+this.xorigin,c=g,this.gfx.lineTo(l,c)}_=!0}this.gfx.stroke_end()}else{var R=-1,f=[],G=[],E=[],T=[],D=!1;for(r=0;r<=this.xsize;r++){var m,x;if(R>0&&(D||r===this.xsize)){for(var u=1,F=0;R>u&&this.AlmostEqual2sComplement(f[F],f[u],4)&&this.AlmostEqual2sComplement(f[F],f[u+1],4);)u++;for(this.gfx.new_area(T[0],E[0],G[0],f[0],G[u],f[u],this.gdes[i].col);R>u;){for(F=u,u++;R>u&&this.AlmostEqual2sComplement(f[F],f[u],4)&&this.AlmostEqual2sComplement(f[F],f[u+1],4);)u++;this.gfx.add_point(G[u],f[u])}for(this.gfx.add_point(T[R],E[R]);R>1;){for(F=R,R--;R>1&&this.AlmostEqual2sComplement(E[F],E[R],4)&&this.AlmostEqual2sComplement(E[F],E[R-1],4);)R--;this.gfx.add_point(T[R],E[R])}R=-1,D=!1,this.gfx.close_path()}if(D&&(D=!1,R=-1),r===this.xsize)break;if(this.slopemode||0!==r)if(isNaN(this.gdes[i].p_data[r]))D=!0;else if(x=this.ytr(this.gdes[i].p_data[r]),m=t&&this.gdes[i].stack?this.ytr(t.p_data[r]):this.ytr(s),m!==x){if(m>x){var N=x;x=m,m=N}this.slopemode||(E[++R]=m-.2,T[R]=r+this.xorigin-1,f[R]=x+.2,G[R]=r+this.xorigin-1),E[++R]=m-.2,T[R]=r+this.xorigin,f[R]=x+.2,G[R]=r+this.xorigin}else D=!0}}for(r=0;r<this.xsize;r++)isNaN(this.gdes[i].p_data[r])&&(t&&this.gdes[i].stack?this.gdes[i].p_data[r]=t.p_data[r]:this.gdes[i].p_data[r]=s);t=this.gdes[i];break;case RrdGraphDesc.GF_STACK:throw new RrdGraphError("STACK should already be turned into LINE or AREA here")}this.only_graph||this.grid_paint(),this.only_graph||this.axis_paint();for(var i=0,e=this.gdes.length;e>i;i++)switch(this.gdes[i].gf){case RrdGraphDesc.GF_HRULE:this.gdes[i].yrule>=this.minval&&this.gdes[i].yrule<=this.maxval&&(this.gdes[i].dash&&this.gfx.set_dash(this.gdes[i].p_dashes,this.gdes[i].ndash,this.gdes[i].offset),this.gfx.line(this.xorigin,this.ytr(this.gdes[i].yrule),this.xorigin+this.xsize,this.ytr(this.gdes[i].yrule),1,this.gdes[i].col));break;case RrdGraphDesc.GF_VRULE:this.gdes[i].xrule>=this.start&&this.gdes[i].xrule<=this.end&&(this.gdes[i].dash&&this.gfx.set_dash(this.gdes[i].p_dashes,this.gdes[i].ndash,this.gdes[i].offset),this.gfx.line(this.xtr(this.gdes[i].xrule),this.yorigin,this.xtr(this.gdes[i].xrule),this.yorigin-this.ysize,1,this.gdes[i].col))}return 0},RrdGraph.prototype.graph_paint=function(){return this.graph_paint_init(),-1===this.data_fetch()?-1:this.graph_paint_draw()},RrdGraph.prototype.graph_paint_async=function(){this.graph_paint_init(),this.data_fetch_async()},RrdGraph.prototype.find_var=function(s){for(var t=0,i=this.gdes.length;i>t;t++)if((this.gdes[t].gf===RrdGraphDesc.GF_DEF||this.gdes[t].gf===RrdGraphDesc.GF_VDEF||this.gdes[t].gf===RrdGraphDesc.GF_CDEF)&&this.gdes[t].vname===s)return t;return-1},RrdGraph.prototype.gdes_add_def=function(s,t,i,e,r,h,a,d){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_DEF,s,t,i,e,r,h,a,d))},RrdGraph.prototype.gdes_add_cdef=function(s,t){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_CDEF,s,t))},RrdGraph.prototype.gdes_add_vdef=function(s,t){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_VDEF,s,t))},RrdGraph.prototype.gdes_add_shift=function(s,t){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_SHIFT,s,t))},RrdGraph.prototype.gdes_add_line=function(s,t,i,e,r,h,a){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_LINE,s,t,i,e,r,h,a))},RrdGraph.prototype.gdes_add_area=function(s,t,i,e){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_AREA,s,t,i,e))},RrdGraph.prototype.gdes_add_tick=function(s,t,i,e){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_TICK,s,t,i,e))},RrdGraph.prototype.gdes_add_gprint=function(s,t,i,e){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_GPRINT,s,t,i,e))},RrdGraph.prototype.gdes_add_comment=function(s){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_COMMENT,s))},RrdGraph.prototype.gdes_add_textalign=function(s){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_TEXTALIGN,s))},RrdGraph.prototype.gdes_add_vrule=function(s,t,i,e,r){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_VRULE,s,t,i,e,r))},RrdGraph.prototype.gdes_add_hrule=function(s,t,i,e,r){this.gdes.push(new RrdGraphDesc(this,RrdGraphDesc.GF_HRULE,s,t,i,e,r))},RrdGraph.prototype.tmt_conv=function(s){switch(s){case"SECOND":return RrdGraph.TMT_SECOND;case"MINUTE":return RrdGraph.TMT_MINUTE;case"HOUR":return RrdGraph.TMT_HOUR;case"DAY":return RrdGraph.TMT_DAY;case"WEEK":return RrdGraph.TMT_WEEK;case"MONTH":return RrdGraph.TMT_MONTH;case"YEAR":return RrdGraph.TMT_YEAR}return-1};
